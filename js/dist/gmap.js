/*! p4 2016-02-07 */
function initMap(){google.maps.visualRefresh=!0,initLatLng=locations[0].latlng;var a={center:initLatLng,zoom:7,mapTypeId:google.maps.MapTypeId.ROADMAP},b=$("#map-div").get(0);map=new google.maps.Map(b,a),infoWindow=new google.maps.InfoWindow({content:$contentNode[0]}),google.maps.event.addListener(infoWindow,"closeclick",function(){replaceDeletedInfoWindowNode()}),placesService=new google.maps.places.PlacesService(map)}var map,placesService,iconLabel="ABCDEFGHIJKLMNOPQRSTUVWXYZ",markerList=[],currentMarker,infoWindow,$contentNode=$("#info-window"),setNewLocation=function(){infoWindow.close(),resetMapMarkers(),resetMap()},changeMapLocation=function(){selectedPlace([]),foundPlaces([]),placeType(null)},resetMap=function(){map.setCenter(currentLatLng()),map.setZoom(14)},resetMapMarkers=function(){clearMarkers(),replaceDeletedInfoWindowNode()},setMarkers=function(){resetMapMarkers(),filter(""),getPlaces()},filterMarkers=function(){resetMapMarkers(),addMarkers()},clearMarkers=function(){for(var a=0;a<markerList.length;a++)markerList[a].setMap(null),markerList[a]=null;markerList.length=0},getPlaces=function(){var a={location:currentLatLng(),radius:"2000",types:[placeType()]};placesService.nearbySearch(a,buildPlaceList)},buildPlaceList=function(a,b){searchStatus(b),foundPlaces().length>0&&foundPlaces.removeAll(),b==google.maps.places.PlacesServiceStatus.OK&&(foundPlaces(a),addMarkers())},addMarkers=function(){for(var a=0;a<filteredPlaces().length;a++)addMarker(filteredPlaces()[a],a)},addMarker=function(a,b){var c=new google.maps.Marker({place:{location:a.geometry.location,placeId:a.place_id},title:a.name,icon:{url:"img/src/gm-markers/pink_Marker"+iconLabel[b]+".png"},map:map});c.addListener("click",function(){setCurrentMarker(c)}),c.index=markerList.push(c)-1},setCurrentMarker=function(a){currentMarker&&(infoWindow.close(),replaceDeletedInfoWindowNode(),currentMarker.setIcon({url:"img/src/gm-markers/pink_Marker"+iconLabel[currentMarker.index]+".png"}),currentMarker.setAnimation(null)),currentMarker=a,highlightMarker(currentMarker,"green")},highlightMarker=function(a,b){a.setZIndex(google.maps.Marker.MAX_ZINDEX+1),a.setIcon({url:"img/src/gm-markers/"+b+"_Marker"+iconLabel[a.index]+".png"}),a.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){a.setAnimation(null),openInfoWindow(a)},1500)},openInfoWindow=function(a){placesService.getDetails({placeId:a.getPlace().placeId},function(b,c){c==google.maps.places.PlacesServiceStatus.OK&&(selectedPlace(b),infoWindow.open(map,a))})},triggerInfoWindow=function(a){markerList.length>=filteredPlaces().length&&setCurrentMarker(getCurrentMarker(a))},getCurrentMarker=function(a){for(var b=0;b<markerList.length;b++)if(a===markerList[b].getPlace().placeId)return markerList[b]},getYahooWeather=function(){var a="select * from weather.forecast where woeid in (select woeid from geo.places(1) where text = 'Binghamton NY)&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys",b=yahoo+encodeURI(a),c="https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20weather.forecast%20where%20woeid%3D2502265&format=json&diagnostics=true&callback=";console.log("good: "+b),console.log("bad:  "+c),$.getJSON(b,function(a){console.log(a),console.log(c)}).error(function(){console.log(c),console.log(data),console.log("FAIL!")})},getYelpData=function(){var a="https://api.yelp.com/v2/search/?",b="ll=42.0964782196554,-75.9702992976657,0.00&limit=1&callback=?",c="https://api.yelp.com/v2/search/?term=food&ll=37.788022,-122.399797",d=a+encodeURI(b),e=a+b;console.log("good: "+d);var f=$.getJSON(c,function(a){console.log(f),console.log(a),console.log(e)}).error(function(){console.log(f),console.log(d),console.log("FAIL!")})},formattedDateTime=function(a){var b=new Date(1e3*a),c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],d=b.getFullYear(),e=c[b.getMonth()],f=b.getDate(),g=b.getHours(),h=b.getMinutes(),i=12>g?"am":"pm";g%=12,g=g?g:12,h=10>h?"0"+h:h;var j=f+" "+e+" "+d+" "+g+":"+h+" "+i;return j},replaceDeletedInfoWindowNode=function(){$contentNode[0].length||$("body").append($contentNode)};