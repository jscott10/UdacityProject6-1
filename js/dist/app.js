/*! p4 2016-02-07 */
$(document).ready(function(){var a=function(a,b,c){this.name=a,this.latlng=new google.maps.LatLng(b,c)},b=[new a("New York",42.900956,-75.664966),new a("Binghamton University",42.088848,-75.969491),new a("Stony Brook University",40.912465,-73.123389),new a("University at Albany",42.686139,-73.823944),new a("University at Buffalo",43.000815,-78.788986)],c=function(){var a=this;a.placeTypes=ko.observableArray([{type:"airport",name:"Airports"},{type:"aquarium",name:"Aquariums"},{type:"art_gallery",name:"Art Galleries"},{type:"atm",name:"ATMs"},{type:"bakery",name:"Bakeries"},{type:"bank",name:"Banks"},{type:"bar",name:"Bars"},{type:"beauty_salon",name:"Beauty Salons"},{type:"book_store",name:"Book Stores"},{type:"bus_station",name:"Bus Stations"},{type:"cafe",name:"Cafes"},{type:"car_repair",name:"Car Repair"},{type:"convenience_store",name:"Convenience Stores"},{type:"department_store",name:"Department Stores"},{type:"food",name:"Food"},{type:"grocery_or_supermarket",name:"Supermarkets/Grocery Stores"},{type:"gym",name:"Gyms"},{type:"laundry",name:"Laundry/Dry Cleaning"},{type:"library",name:"Libraries"},{type:"liquor_store",name:"Liquor Stores"},{type:"lodging",name:"Hotels/Lodging"},{type:"meal_delivery",name:"Food (Delivery)"},{type:"meal_takeaway",name:"Food (Takeout)"},{type:"movie_theater",name:"Movie Theaters"},{type:"museum",name:"Museums"},{type:"night_club",name:"Night Clubs"},{type:"park",name:"Parks"},{type:"restaurant",name:"Restaurants"},{type:"shopping_mall",name:"Shopping Malls"},{type:"store",name:"Stores"},{type:"train_station",name:"Train Stations"},{type:"zoo",name:"Zoos"}]),a.placeType=ko.observable(),a.currentLocation=ko.observable(),a.currentLatLng=ko.computed(function(){for(var c=0;c<b.length;c++)if(b[c].name==a.currentLocation())return b[c].latlng}),a.foundPlaces=ko.observableArray(),a.filter=ko.observable(""),a.selectedPlace=ko.observable(),a.searchStatus=ko.observable(""),a.fsTips=ko.observableArray(),a.getFSVenues=ko.computed(function(){if(void 0!==a.selectedPlace()){var b="https://api.foursquare.com/v2/venues/search",c={client_id:"LKOCAAQC2EHG2YHBHPKMX2TAIHXEOXL3U2GQSCHN5542VYJE",client_secret:"QLLAGNKK2QOLH054PMAPYU1PUQQ4G3YNCOU52WBCH3HDKOQJ"},d={ll:a.selectedPlace().geometry.location.lat()+", "+a.selectedPlace().geometry.location.lng(),query:a.selectedPlace().name,intent:"match",v:"20160101",m:"foursquare"};return $.extend(d,c),$.getJSON(b,d,function(b){if(b.response.venues.length>0){var d=b.response.venues[0],e="https://api.foursquare.com/v2/venues/"+d.id,f={v:"20160101",m:"foursquare"};return $.extend(f,c),$.getJSON(e,f,function(b){a.fsTips(a.sortedTips(b.response.venue))}).error(function(){return console.log("error1"),!1})}return!1}).error(function(){return console.log("error2"),console.log(d),console.log("Status: "+r0.status+" ("+r0.statusText+")"),!1})}}),a.sortedTips=function(a){var b=a.tips.groups[0].items;return b.sort(function(a,b){return a.createdAt==b.createdAt?0:a.createdAt>b.createdAt?-1:1})},a.filteredPlaces=ko.computed(function(){var b,c=a.filter().toLowerCase();return b=c?ko.utils.arrayFilter(a.foundPlaces(),function(a){return ko.utils.stringStartsWith(a.name.toLowerCase(),c)}):a.foundPlaces(),b.sort(function(a,b){return a.name==b.name?0:a.name<b.name?-1:1})}),a.statusText=ko.computed(function(){switch(a.searchStatus()){case"":return"Please select a location type from the list!";case google.maps.places.PlacesServiceStatus.OK:return"Found "+a.filteredPlaces().length+" Locations!";case google.maps.places.PlacesServiceStatus.ZERO_RESULTS:return"No Locations found!";case google.maps.places.PlacesServiceStatus.UNKNOWN_ERROR:return"Unknown Error. Please try again!";default:return"Unspecified Error!"}})};ko.applyBindings(c)});